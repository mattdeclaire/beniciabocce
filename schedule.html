<div id="bocce-schedule"></div>

<style>
#bocce-schedule .tabs {
	margin-bottom: 1em;
	text-align: center;
}

#bocce-schedule .tabs li {
	display: inline-block;
	margin: 0 5px !important;
	padding: 0.25em 0.5em;
	border: 1px solid #CCC;
	border-radius: 3px;
	background-color: #F6F6F6;
	cursor: pointer;
}

#bocce-schedule .tabs li:hover {
	background-color: #FFF;
}

#bocce-schedule .tabs li.current {
	background-color: #FFF;
}

#bocce-schedule h1 {
	margin-bottom: 0.5em;
	text-align: center;
}

#bocce-schedule table {
	margin: 0 auto;
	border-collapse: collapse;
}

#bocce-schedule th,
#bocce-schedule td {
	padding: 0.25em 0.5em;
	border: 1px solid #CCC;
}

#bocce-schedule td.court {
	text-align: center;
}
</style>

<script>
jQuery(function($) {
	var key = '1HJP6Ws5T5zQ4F6QW3UGrJb_Cj8VlsAcugxt8xFIpO7s',
		divisions = [
			{
				button: 'Sun/Mon',
				title: "Sunday - Monday Division",
				sheet: '2096572205'
			},
			{
				button: 'Tues/Weds',
				title: "Tuesday - Wednesday Division",
				sheet: '1511857299'
			},
			{
				button: 'Thurs/Fri',
				title: "Thursday - Friday Division",
				sheet: '34811725'
			},
			{
				button: 'Sat/Sun',
				title: "Saturday - Sunday Division",
				sheet: '1623939713'
			},
		];

	var tabs = $('<ul>').appendTo('#bocce-schedule').addClass('tabs'),
		contents = $('<div>').appendTo('#bocce-schedule');

	$.each(divisions, function(ndx, division) {
		var tab = $('<li>').appendTo(tabs).text(division.button),
			content = $('<div class="division"><h1>' + division.title + '</h1></div>').appendTo(contents),
			schedule = $('<div>loading...</div>').appendTo(content),
			url = 'https://spreadsheets.google.com/feeds/list/' + key + '/' + division.sheet + '/public/basic?alt=json';

		$.getJSON(url, function(data) {
			var games = getGames(data);
			schedule.html(scheduleHtml(games));
		});

		tab.click(function() {
			tabs.find('li').removeClass('current');
			tab.addClass('current');

			$('#bocce-schedule .division').hide();
			content.show();
		});
	});

	tabs.find('li:first-child').click()

	function getGames(data) {
		var games = $.map(data.feed.entry, function(entry) {
			var cells = $.map(entry.content.$t.split(','), function(cell) {
				return cell.replace(/^.*: /, '');
			});

			return {
				time: entry.title.$t,
				court: cells[0],
				home: cells[1],
				visitor: cells[2]
			};
		});

		return games;
	}

	function scheduleHtml(games) {
		var html = '<table>';

		html += '<tr>';
		html += '<th class="time">date / time</th>';
		html += '<th class="court">court</th>';
		html += '<th class="home">home</th>';
		html += '<th class="visitor">visitor</th>';
		html += '</tr>';

		$.each(games, function(ndx, game) {
			if (!game.home) return;

			html += '<tr>';
			html += '<td class="time">' + game.time + '</td>';
			html += '<td class="court">' + game.court + '</td>';
			html += '<td class="home">' + game.home + '</td>';
			html += '<td class="visitor">' + game.visitor + '</td>';
			html += '</tr>';
		});

		html += '</table>';

		return html;
	}
});
</script>